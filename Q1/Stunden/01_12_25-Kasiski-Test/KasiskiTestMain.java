import java.math.BigDecimal;
import java.math.BigInteger;
import java.util.Collection;
import java.util.Collections;
import java.util.HashSet;
import java.util.Set;
import java.util.function.Function;
import java.util.stream.Collectors;

public class KasiskiTestMain {

  private static final String TEXT =
      "ÄIZGIJIOCIÖAQÖÄIßSINSDYMÜLNCZÜAVXREJAMWGRUJUGWCJSBGDßEVAÄÜAVXSMVALPLVXÜYABÖHHUVQXMNANEAVXWAMÜUGCUIAÄVBÖSTFEXANXIAEAKXWDFALSEOAADUHXÜTFSMREAGKWYHXNNHVZKDROMKACGYHPXZKPUÖKWYWHQECVVOIÄXKJRYXXACVZLEBVßBBRXNNFÖTOIÄXRYZßXGLJALßEGIAÖEBTREXRZVOAXEÜCGJRHJAIASIJÜYYWCNNEZMCEVIÄÄESBRAUZSNEAZJEQWDÜMPKZSECÖßHUSKTNBSLKEBWGHGKÖRMFÜMBOÄUTIVBßTMNRÖKWVAZYAXGFGFMMSCUXFKAVÄNNUVZRÄYIAÄVBHJMJÖWVIQDYÖUSHGLJALßEGIYÖVBANEAFQMHÄÖYÖGTXNRSVVOSÜTYAGWHJIOVÄSEOXFLVFHFLJVVÜCUDXIZUÄXEJAQXICÖWBZBWJNHPZßEYJFXßSVMTFFQMHNJÖXVBLJGBÜÄOSQÖÄYEGIJNIPOOLQXKAHFHNVHVJSRTXKYEÜATMNVVRACIÄMRFYJSFZVONYXLPGWCGLJTSFUARYARIYIIFFSELVCÄIVÄCJRIVQWACHLUUHUZCIFÖKBUTMIVBWNEIVINLVCÄLBBTQPIRJOTQDJZHBWIIFFÜLLVCÄIVÄCJRFZOONRCKJESSJDFEDOIYXFÄRGHJWFYUITVZDÜVXÖMMFZVORRIßEEÄHHHFWZKGRRXYEVÖJWBAOODNCFIVHOYEFFÄOIÄXFMVYYTRUHVßEALÄÄFHGFFFFMSNRVGFLVÖJCPCCCAACLYUSHGLJALßEGIYÖVBWFWPFQOHRGCQßWLBRFFQOZVZEUÜIBLETTPÖIRUÄDJCGIEOHVNAYAÄIJSHÄOOZPÖEZJJICFJSGOBKRÜOGAÄJOGJSFZLKSFDJJHBWZNEUIÜBYÖFXGWMYCIVVÜOYAÄKßÜXMRFAÜXDFÖÄXVFÖSSFZVOITXFYFGÖHHFEMÜLNCZPHFRHKLVPÖEÄWGWYSAQETXÜßZDGÄXVBßTNOGMOSÄÖYÖGQUJRÄVÜQEÄJFXFCWFUFEÖOEBCAWYHAFNHVJSSVÄEYZBEFASYMSMCRYAZGVMEXVZLECXPJVFTZFMRÜORCXFYFAÖYLPAOOUÄWHUECAJBFGZANXXFCRUÄYEOHVNEBWWDAÄCNHSVIQEÄIMHFUÄQEQCÖONFDKÜVWHKÜSZPÖEÜGGßVÜIJWJVLORDCZMZWWJRNZHLRNJYÖGWCZNEJMXNRHFÜTZIZMHVÄMHAÖÄVVBLZREVLKNÄUÄDHHOJNTZMOSVBEYEBDHHXVQßHVCLYAZÖSTFELONFDJJSWGLEOWMÖNQXJBNBWJRWBSKLVXFKAVßTNTBVKNCÖÄDÜWUJNEZMLLVCZJVLIJACXMÜCUÖÄXVBLTHOVVÜIRÖFVHUÄXTBSPKUBXFUAVXWKßFÖODRHKYßSCYILVQXEBZJEQWCXPSRKROIXWDFWÖSKMVQXEBUSWYßXNNORUONBWMXVBYQIFQÖNUAVßÜYFXSOSGÜXDEXJIBFZYSJVUSTQXFDOHÖLEOEMQEYÖWBZWCJSJFÖOIÄEWHRVÖJSNRÖSSPÄÄIÜSCIIOUMWEVCÄCXWUWAUVVOSNIRJVÄAJIOUMXMDCZZÜÄXLEOAQMHCXADßSAÄOOUMÖAYAEQTZINGFAQXTRGHKAÜINOOJMÖDRCZÜVTANNEGMDTRUÄÖVFGXCIGMSNTXJUUWOZUOBZßHÖZJUCZÖXCIVÄVEOXFYZBXXTBXMÜAOXJVVGVMLPQMSNRßDYZBXAEJÜMLLVCZJVLINHSAIWEFTJBBFXRIQFÜWHVCWKFNJLEIVVSNQÖÄMVÄIJGSRUWACÖCXVFZWOAVWDMÖMJÜVHÖMRERßYNNUZUVGWTRUJQWMRAÄLBBUCSFASYMZTLUJÄAIEOWZKGROÄÜTZXSUOUPSNCXJÖNßINGFAÄOMVßGBZVDHHERÄLLVCZJVLIHHFATSEMHAWYBÖHHUSMSRAXFYFDTHKUVÄOIÄXKÜVTXSVFEÄKLVXFITZDGSJTPÜEVCADZHÖFLJALONTRJJVßJSDNRKRTRHAWYSJKDFAAOGNAKYFVÖJESFÖONURÜYÜVXXKVEÄSVTXXÜEYXXESÖTYMZXFÖRHIJWBENOSRÖFYAßXYZUVVLLVVCPHFRHKBHNNIRHCOÜÄCJSFZVORUXACRHHYAEGJACUHLUSZTZSFALSEUXWXÜÄCJVPAIVPUTXYGVDWFVALNIRHMVÜÄCJSFZVORRÖÜYAWCXTSRHODRGRYZßXSGBFÄOWRÄESGÄZQIFWQRMRÖFYEWIMOSZÄMHRYJUXWRGESUQOWNCÜYUSCSSFGDßERHKYZBXSWFXNYRCJFJVFLJGTGZKFRHÄÜAWVTPZUQOCÖEQMRFCYEERÄLLVCZJVLIHHFALKWÖHAYYWGPÄNVAGRRHAYMÄZRAMHUQEBVßHZWUJNXBZNEÄJFXRßAJSXRÄBOÄÖßHVAJWSQEÜXGÄDYÖPTGNGXNZOSRÖZUFKDWTVALANQWWISßÖSDUVBßCUXFIBßAJUNÖMRRRCMDUKÖJDFEQXSRÖFYZYXSETFQMHRGÄIÜSCIZVEGMKXXßHVBWTCIRTVEBZMJMIGJDFASYNÄIÄYFBÖHHUPJORIXMÄVBJSDTBLKURGLYVGCNCIGTKNTXXÜFÄÄREJAXKAAÄÄÜßHRHKJFKREFXJVVHXÜTFEIAFYTMYEHXSETßQßLÖCÜYHBWUASBTOBRIJKAÜXSMBTPßEÄJFXVGWFNOZVSHAXWÄVBIZRTTPVEÜELYAKDXIFVÄPÜAÖßHVDGTJFÖÖOWVXZYEICIWJVLORZÖVVESJHHUVVANQLÄDAWHSIDYÖAMTXKWYFÖJBFAAARQXZUABUJNVGDONBÖÄYFÄBRESAWMHFXAJYÄCYEOYQXTRGZYAKDWTCVZQEÄYÄHAVXWLÖALOREDCUÜÄXSUOUSYNBDFUAHÖJNMVJONQÖÄVÜÄCITFKÖOAOZÄITZÖJDFAAYHÄXFIZWÖSBVTPÜTNUßUHGXSAOUMÖKLHLYUWHXENRVßIXXADVGZWOAVVÜPATYÖBNXFNTVQXKYXADVGUBCIÜMSNÄTEYAGWZDFANVIRSLXHFVMIIEMXOAIMDUJXWSPEOßSVXEÜGVXSNÜGQQEÄGÄÄVßÖFLJVVOSVHLYZBEFRBUQOSZTLÜFUÄJSMRVNIÄWÄCVÄCJMHVJÖACXFYFSIATFZTOIÄWÄDßICIFMZMQEÄCAWYHXNNNRTBOÄWÄHRßARÄDYÖSGRCADGWGUUOÖÖSOÄLÄHUWCIIFSTSNQIÄNGWUJHFEZÜCUIÄÜAYXWAEVDAUÄDJJYCZWAQYQÜCUXKBVTXSEJAMÜTNZÄIRTXWBFFKRLÖSÄÜAWßQEJAMFEVAÄVÜÄCITFKÖSHACWCVKTWLPEMWIÜHMCYÄCFUTMÜQEUXFÜAVÖJWFZÖOGATECRHÖPDFEOÖOMXGNßCMWIFGQRRQTNEASUIAFFLYRCLACßWAJVPAJHSRCCEßATYAXZTNEÄYJUXWOJIDYMXUÄWßÜAHXWHÖÜÖSGRCKYßÄßTLJUWMHQTKVÜÄCITFKÖMHRCDÜVRHNCIAQMHCUÄÜEFXSETCIMKCXKYZBXXIFSMXVRGKUÜÄXSSDYWLSVVßIVÄCNNJGQKLVCZYAYRWTFÜÜXDZTYÖGWHNCIRÜPDRCOYXSAXETUQOEAHLYAZRLEMUMÜKDGKÜIYXGISXMÜEAßDEßAXSHBGÖOWNGÖYFWÖSEOÜMßZCXFVÜÄVPZVEGMKNJÖXZWHPYMZVOSRÖFYEZXNMBGÄßAQIXKTZHYACYIASRCZÜVZXFDMZVOVÖCWBCZTGEUUWÖFDCZXZWHZBMZVOSRÖFYEWÖLEOVVÜTATVYUWGAEJÜMXGNHKYJWÄRÜUZOVIRYAÖßWÖSESVÖROAÖKWYWYWAHVGLEAWAYJSCLEERVXSRIRJVWHXEJAMXWRZÖEEHJSTFEAOGBIJUWWHJIOVKYPHWAYTCEßWBEVßEQTKVÜÄCITFKÖMHRCZUJCHNEIVZUÄZXOQEWHNEÄZOWAYJEÄVGVMRJVJONFDJXVBJSDBÜTOSFTKLBBÖMRFßÜÖSÜGMDXBDHHßSZSGFPJYFWÖIATJWÖTDCZKAVWFSCÜQXDCXPJTZXSSPÜTOUZßÄÖEWCZNEJQODRGADFWÖSEJXMXEBHAWYWGJSMRVNZDGUWÖÜXMRFALYCUTDBVGZZTÄHZODRCCEABIJETAQMHCRXYENXZGFAÜXDBDZUHWGYEFFVSCUIDUAYXGITZPWEVCHURFÄJINGGMKVHYÖVKXWBFGMDTRGWKWßTZESGMXEBBAJÜCCLEVALZAADDYSWIWUOÖMXMNVßJVBJSDFFLKNÄÖFÜYFXFGFAÖARBVßBVDEYEOJWÜIRXKZPFÖMRFCZYJRßLYJÄXIESHVNWVXZYEAÖEBSRÜMHCXFKAVLJNOVÄXIPÄLKßYXXCIEQOBRCOKEVXIAOAJONDIRYAGÖJETZUWEACGWYKXNTIZVßEÄÄADGWGIEOJWÖTOXJÄVBYJROUMÖLJCZYEJDPAMZMXUÄWCEAGDSAOGQONYXXYAVÖJBMZVNTRMLYRTZJSDYQODRCOEYBXSSJVQXBDVßIGSUMAVFMXAÄWÄHÖQHYEEVÄÜEZTFJZÜXNNFFOÖOMXFICFTHHPMMKNBXADÖßXNNFFJGCUAÄÜABTREOFLADRCÖBZWSYDVEKRIUGÄDBFIZNEIMÖSÖGÜJFÄXRIUUMXNKIAÄVBGJGFÜQKLVXFYFÄHYEJAXKRNWAYFATYITTPOSYTFXZBWJMFZVOMTXXHRHXSETRÖFTRÖDYZBWJNNHVNFYÖÄÄVBCNCIGMSNZTDLBBWJRBÜTWÄPÄLÜXWCNNUVZZUÄßLÜBBLJREVVNIRUDÜAVIJXUVJOHRGJITZIJIOXMÖAQXRKHBDWTIBOÖAÜÄAITZXXLFSMXEVCÄIGSZJSBSMÖBRHYÖÜCSJIOVSVEVCÄPVÄAJBMZVNTRMLÜYFCFMFJIÖLÖGÄCZDHZMIZVKUBOMÄVZXSIOUQOWRÖLYXFTRMBGQUDRGÜHBRXTXNBBÖIRIAÖEVTÄOORJNARHZEEHLNMNVTOVÖCXRFWCPONßIßAFÖDXVBYWAHVDOIPÄÄDHBWMIOGMÖHJALÜXWCXENZSYLVWGWYVTXBMZVNTRMLWYWCQIFQÄSCUCAWYHUJISEMXEBEWWÖHXXEJAMÜIRUÄDIWGXAMZMXSPÄGVFÄVMSFZVSNVIAUÜÄCIEOXGÖTRAMDUATHHUVÄSCUTMZUWCÖEHRTÜEBWAYVFHYEOYGQEYWÄIÖIGXIWXMLIAZÄIVFßQONßMXHNILYJSGKETVQXEÄAÄJMHXSBMZKUZDGUWÖSJKDJVÄUYYÖFYFWÖSESYMSMNIKJRVIGUDYÄßAOÄWKFWCIIFYMKDYÖFYICCFLQYILECWGHWICIDJVÄABYÖFYFWÖSESVQQEÄXFIGFTEEEVZFEVAÄDXSHXEXVPWÜCÖÜBZWYNHNVQXEAXLÖBFÖXCIVNÖATXUVVFWNEXRVQEQTFDFWIATFVÄÜEVCÄDJWZKOSGÜXTRGOYXGIWAGVÄOIÄXYECMWNEDBXEWNGFJVVTXBMZVNTRMLWYWCIAXBÄSEUXJANAXÖÄSVÄSEIÖÜCRßJRGFFKRRVXXYAKDWDFAÜXDNADYFKTXVPAQRRRBMHFDGZNHAWMHLUJÜXKPWETVQNABLGHGICIUOULKSOAADUHXÜTDYMXSÖADYHAßJHSVVANQLAYUWGNNTVQXEVZÄDVGHNCIVZOSYTFXMIGDCLÖMRRRCZETZTQLFFOATIJJYUWCPOOAÖOEBCAWYHRGESMMAGRCMDUGDIAVVZßERHFÜTZIQAOXMLIBÖßCVÄCUABEPOIZIUWÖÄHHHFJMÖBRIÄNGWGFUGÜIAEAIÄDVGBNTMBVQEDCZFRFDQECVÖÖUÄßÄDßSVMTFAÜXDRHZUABÖSIIEMKGRCLKEGVMLFCXßEÄLGIZWXXFßEQRRREJEÄWßYEXZMNEAJFXJÄXIESßQJBATMWYHXSUOUAONÄXKDZUÄYUNXMÜCUGAYSWCÖUSUMNAÄCXYAIIAEOFQOEBÖECVFCTCIJMSTUÖFJVBÄNNUVZNEÄLGHGTXWGFANORÄWÄHÜOCIESIWUAYÖÄDHBWPOOFWXAÄIAYAßXGEOUQOBYÖFXGWMYEBSOOSPÄAYUWCÖOIAMXSVXADSIVMSURJRADHÄDRBWJRLPÄßEQXKIVATSTJÖMSNRHÜHBRXSSQEIMHÖOÄUAGXNNLÜMSNRHXQTZAJIOAIWEÄHZKUWCKLJVHßDDGYÖZZGJNPEÖANQKÄHFCGLTTZMWICWÄDAPINGFAZOGRAAUÜÄXSETZÄßEVCHUESWNETßIßIBVßYFßTSDJALOMRÖFYßYXGRBGMXEBTLPGWÖQEJALONZJFXWßÖJGFAVSCUIÄÜAATQVPALORNADCNUÄYIHVVSNCXJFHBßYIPAAORQXFXZWUQIOUÖOXCXXYYWGWSDYÖOIÄZÄHRVXAUVAWÖTUDÜHRDÄNSDYMÜLRUÄDVÄCJSUROOSNUÄHSWHHHMBHOIÄXCBVÄCJZFZTOBYÖFXGWMYIIEVKMRLWHÜCGJMJCÄAMUÖFUHGOZGFYMXIÄWAYJWÖYEHEIWMNIAAUWGLRPQMYXZDPHZWINHSUIBOÄTXXRWHIOSGASMZXDYICCGÖTVVUOZBWJRKÖQDFANÖATXRYZUÄJNVALRIÄIÄHYOAYIHVVÜEZÖCEÜÄWTCIUIÜBYÖFXGWMYCIVVVIRSKÜTZCNCIGJOIAGÄDVGEFCLGMÜEVCÄIZWUJNWVZÜAYÖÄDFUÄTBTZKRSRÖFÜAÄINAMZVNEÄZUHGWAZNEßIMHCXKÜTZTZFEVVCETTDIVGWNEFEÄßEÄÄUÄVßWJSLHZÜIEZÄVZFZJSFESVOZBÄDYSIYEXRZPEBXADVBAJTÄGMXBYÖYAMIGDCLRÜPDVXKALßÖSETVQXEAÄÄÜßSIXTBUÖLUPÄKJRTÄFUTVVNIRÄÄUUßÖSEWBVKLÜÄWVVHWTRGHVNDVXKKSßÖSETVQXEAXAÄVBXSSUEIJEQXJPVÄAJNHRÄÜEFXßCPHÖLLJVNSHZXADVFXYHPEQÜCUXÖHRYXDBFELSEFTFÄVVTSNTVÖFTRXKIVÄCJNXVOPOAIMDGWGÖEHFÖÖASXKYZBXHOQLLSEPDHOJSGSTFUIÜBYÖFXGWMYCIVVNAFDKÜVZXWKÖßMCÄAXKÜVNÖLMBÜÜWGRHYÖEÄXGEOJWÖDRCMDUSAQETJIÜVÖCAÖEWBZRTCZANTCGWYQUWIHJEÖEBXAXRGLTRUHVNUÄWZUFTANNEGMDTPÄÄDFCAQEVßSOHAXFKAVLNEEVZSNBXADVÄZJNFFÄSCUXJYFßTSDÄHZICXßÄÖEWCIODYIVLRHÜKGNJWEEVVUOÄCLYVGCNCIGGLEAOÄKXWCZNEFWNADXJJVWHSIDYÖVAÄZÄVZGÖMMFZVZANGßYZAIDCLZÄMHRLÄHSWIJXUVZKUSAWKVFIJNFFUSTYDFÄVICIPBEWVEOXLHHBßJNNRKRTRCMDUWHIAOAQXIUGÄUXWCYUSFKRLREHJVBLTSJVMÜFLGAÖEWEWOKVSßEFÖÄXVFJSDXZMNEABATSFTZCIGMXUÄWOYABXXNJTPßUZZÄITZGNECVVCUAWÄXRBCGEOHÖFEÄHAYVGÖRMFEVYCULÄÜGZÖSTFAPSNCXJXVBLTRUSMÖGRCÖYEBWJRMNVNEAKGARßÖJNVALUOÄHGDRBINEOÜMLEÄWAYSßÖSDUVBßENUÜYFUÄNEEVVCOUCÄDFÄXNNCHKRSCTXÖRIHJNBALORXRKJVVXXSFßIXTVßÄÜAWHLRPQMXSÜGWWYCOJAOFMSNXAÄÜAWHGÄDYTOIÄCWCVBHIUEVVPLVXVJUIGHHJYZONÖGLKAVKJRTBZQTBÖÄCZHWJNOOÖSGRCJYXWANAMZMXEBÖKJVÄCUASRLSEBBWJZGVMETÜIXDVCZYßWÖSENXMLRNIÄDVGTYZUVQVEVCZYAAJSDGÜQOGRCFÜTZIJIOßIVVÖCZYESAQMÖTPßITXFÜAHXWPVASßIÖCOYEVXSDJVJVIÄWLYKHXGEIVZÖSPÄLYZBZJRBUMFUDCGHGZDLRBCPSSPÄÄIÜWUJNFZVOSCTÜYFSUJRCVÄMHYDVYZBXPLFZVOZRÖDYSßÖSDUVBßIUGFUßWLFRMBZOMVEKKßZÖSAVFDAGRÄÄDZBWNEXVQßETGWCßSINKEVZQRÖSÄEKADÜRJVÖSHAWWLBBTGDBVÄNOAIOÜßAXQEWBVLÖBXFABABFTBJQVDRCÖHRYXAEJTPONDCZÖZBIJRINTßITXFIVAÖPOMZLYCUWWISßÖSDUVBßCUXFBZWSXIDYVSCUIXYZFGJNFFXKCXIÄIVÄCJSJVJONEXJIRßÖJNTTPYBBÖYÖFWÖSIOZÖSAYÖFXVBZDRUVTANQBWWYHXXIDYIAFQXFMVYTQSFFLSERGKJVBÄDGFÜLOSXJJIZJZJBJEOOSRGCBBABJNIRÖßEFTJZVGXNNFATOTIIÄDSßÖHKÄHZICXTMZUÄXXKZÜQXEBXADVFÄJINRÖÜTNWLVHUÄXTBSPKUBXFXZWÄJAEÜQXEEDFUÜDÄFBFGLYRSJFXUÄXXUCÜQXEBXADVFXNGFAMXSCGWTVVXWZFZTONTTKIVKXMMßGQQLVXÖÜYAXNNFEMßHÖGAITZXKRBXMIBRGZÜVKTSGFUIXNBXLPGWXXSFZVONFXÜZBFIZNUVZCETHLHRXXXEJAMMOÜNZÜVUDUYXRZXTRWWISßÖSDUVBßCUXFXRKDXIFYMÖKJBÄMNFXXIFMQQMNAMCXWHHHSZMLEÄLGHUWCZNERTVEBLWIICCNHSVUARBEJKAYCTCIPJÖITLSHVGXNDBFAYRCJFXHBWIATSTSNQIÄNGUÄJNTBTVEDBCYYFXSUOUASEQXJÜAGXNNFZOONRHKÜTZXWETÜIXDIJJSTÜßJHSVVNOPÄWBÜWHLUUMÜÖEQXFABBCYEFFVSCUIUVVFOJUHVVANQHGXRIXWTFVÄXIPÄLBRBZJBJFQRMRÖFFRSGMEJßÖICXÖKWYWLJRCVÖOXCXJUHXAFUFEÖONRHEÜGßDSGFHVNPNGGBVTXYRVASONZTYÖGWCZNEVÄNAÄCADZZGJAHVVßUAHYÖÜWEUTFAAYSVXÄIWQGNHSVXÖOWXCJVKÖJDFEÜXDFÖÄXVFBNßCEIACUIÄDHBWÖEOAMÜNVVßJHAZJSDYZSEOXFMHFWJDBAVLEÄJLPVBHNEFFQWMRGFETZLJIUYQXTRCßÜAHXWDFAAYRCUÄHXWCKESALORYPFXVFKTKBÜQONDCZABBHTNBAÖSEÄAÄVVBWNECÜQXDCXPJVSULETTPSEQXFMBZCJNTZMSNOJYÖFHTGHBHÄONNCZYEÜRXTFUMÜSRBWDGÄßJIOVÄQRÖSÄDFDGFCIBDOAÄHÄÜAÜAJIOVÄLÄPÄDYZBCFMFAÄNUQXFZÜÄXETEHZMHVÄJYACGYUOUßORBDJÄGGÖJMJGLONÄQLÜXWCWEHVTSAYÖÄDVGÖXTFZVZAATZÜVGBFTJFKREBAWDUÄCIENVQXEZZÄVESIJNFFIßZCXABVÄCIEOßÜXDSAAYXWCSIDYÖOIÄBWBICCIESRTVMJVßJZYXSIOGMÖPDCCJZCCÖESUMXDVXXBZBWYEYGMLEUXJHFUÄYEJAOORNWÄPHICTRUYWQRNEßÜFUÄJSMVJONRÖFYFHTLETRJOROXKWYßDEEJAMULRÖFYMWÖQECÜQXDCXPJZZGSANVAKRYDJYßÄEXUNYQXADHRKXWÄJNJALSEFXAJVYGFMNRÖSKQXJÄECSJOYßWDRVXLÜYFWFVPAILDNXKXBFIÖINßMVEEDFVOGXSKPßUKTNLABUWCKRBXMFEVVßYAICIHJAÖORUPDJZYXSSFßQUOYÖZETZWFSCÜQXDCXPJTZXSLJVHÜIPÄFÜTZIGEJEZONRHHUTÜIJSFZVOSVXXYAJXWSBÜQONBVßESGÖHHTVQXIÄÖLÜRßÖSDFAOIRCXDKAVBFCIGMÜIPÄWKWVXSWFXIVSRHZÜVWGXTFAPIGRAZYFÜJWSJIOOBVGÜYFWGPLPßUONUTLJVKTWFFFMSNRCDYGNIJNCÜQMKIJJSTÜTZFEZMÜKHAADVGXNNFEPOIZTLIGSWYBVTPÜTNUßUHGXSDJVPOAQAADVJDSAMCPKBRIZEEXJSDEZMÜUOAADVGXNNFEMSGRCÄDFHGFßFUMÖZRÖDYAYTXSFJMRMLIAÄÜÄXKIIßMSNRGÄJYCGNSDYMPRNZÄSSWGIIFJIXGRWWDAGXYZUVMÜSRÖFYAKXLFPEÖANCXJMVYHYRBWMÜEVCÄWBDNIIFTWZYFTJDGWWFSCÜQXDCXPJTZXSDBJWÜIRÄÄHÖOBJWÖEMÜIROAÄßSAZMHVÄMHAÖÄVVBLTREVVANQTDBVGLFSWBVSHAXEKEGEWUOXVYCURXHZYLBRFFMSDNHOEEHJSDVALNABUDÜAVIJXUTPONBDDBVIBPEIEMXUÄWOÜVVXWIOFMSNRÖÜYAWHXIDYMÖEBAWDUNJWÜDÖSOHAXFXBUÄFLMVÄQUCOMHVVXSKPAVßERHFÜTZIDBFEDOUTXFKAVHTDBHMÖTRXKDZUÄYLBAOOBVHAÖßWÖSPBRZREVBLSTÜÖXCIVAOROXLYKHXWAVWTKURGLYAWHRIUÜWXGRJFXCSGTLFSMßRDCCYAATHHUVVANQXKXRBCNNJYZOATXFJHFHHHMVXZTRCOEFÄXJSGPZSHAXHHBÖXPTFJQODRGMDUKÖJDFEUSßOGWKTZIJNVALCEÄCÄIAÄVMTVßOOSPÄJÜVTXSWVELODNCFVVBJYZFAÄSERHACßWGSODYAOICÄADGWCMIOGMÖDRCOEEHUJRHVVPEACZYEßPSDFEßYKNAAYAICIKPAÄYNNCLÜVBAJBFALSEOAADUHXÜTFRJQEBVßÜVVXSWPYVONBÖÄÜATJHHTGILHNJKYASCIESÖGÜTRWÄIFWBFNUZSOIÄXKÄECSJNTCZKCUDRYRBHJIOÖTOIÄXKVNUÄQEJAVKMRCKXHVXSFMZMJTQJJWYÄÄWEOBZßUÄWNYEGDWGUFQOMVIZYABQYIHVVÖETXDÜRßÖJNFFQÜTRÖFFRFTIIFFUKTVHYÖVGAFNEZVNEZXADVAZJBSRÖONRHWJMHXNLFZVNEÄBMDUXANEHVVXIPÄLYZBBFLWBVNEATDBßOVMTJXMXIÄIÄHCICPTJBVCEAWÄDUÄXGLJALßEGIÄVVZXWRTTPßEVCÜYESWJZVHVYRCÄGÄESEMITTPOSYXXYAWÖSETGIQEBTXYETXXCIÜWJEVCÄAÜWÖSEÄVQVEOAADUHXÜTJYZXAZXOUEßDWENZXÜUZÄADRIHAUHVPONVCZÜVKXNTFXZKMZTLÜÖVXWGSBHOOGBGNEÄXYIIELKVÖCWVUSXXDPEÖCIZBÄBVJDSBÜFMXKÖBEUGSLNLEVVPRNZÄPVÄVMEOHVNHVCLYEZPQTJXMXSRBAABßÖIODYLKSOAADUHXÜTDYMXLVXVIZUÄSIDYÖLEVGJYAWHUADÖÖOSRÖFYFÄXGEOIMÖSNAAYAGVMOCFQMHBXADZBÖYIBÜQXDRCÜSEHXQUOUUKCUIÄIZUÄFUGUMXWRZWBFWHIIFVZÜTRCßSXWAIETÖÜÖSVKÜYSÄGLETVZULÖBEYAZTYTFJIÖFRHÄÜAWCQEUMÖONOAAWÖNJWÜDÖIAFQÖÄIÖMANNFFMSNRGßYZATYSURLßBDVßIGSUMAVFMXDVXßYRVANNFIWXAYEßUSWIIOSWÜXDQÖÄIHTANNFFMSNRGÄÜXWCJNTGZKßRWÄHMWÖQEOXIÜSRLÄÖßQINGMZMPIUBÄÜAWGJTIBZSSPÄÄZESZJÜCVZNIRLWDXWWFNOFMßZCXÄIFWÖSEOJMQFÖGLKAHXWWFXÄßRNYÄIVÄCJCPCCNIRVGFLKTWNUVLKSOAADUHXÜTDYMXDNLGIZWÄJRLNUOWJGÄIZWONGNRTAMTXKWYFÖJBFAAYRQXFKAVTQLFFAKSEDFÜYFXRUSFXÖUÄZFETZRGRJXAGRRHÄÜUSHÖOSGÜXDDCZXRGUQIOUÖOXCVßYAGDQLFHUUEUGÄDHBWÖIFUMÖIÄHÄÜAWÖLEOVÄÜIPÄÄHVGAFNEMÜÖÜPßCYYFXSDPTPKLYXKÄHHOZRFUMXKÖCFJVWHSIDYÖIBRGRYHYXSUOUÄYDNJÄHGWXXNJTPßLNCÜYSÄHNHNVQXPNTJÖVÄBYÜDÖQÜCUXOYETXYEYGMÖADYDUHWGYEOVÄWICAGDXWJSDQRZYLRUÄJEICPEOßIMHCXFKAVXXDBAVSNVÄJYRYXSTVEÄMHYXHFGWCÖOTZMOSSRJÜYFXURPÄMUTRLAYUWGZNEJQODRGEÜQTGFUDYÖONDCZMVBCJSOZKRTDBÜYFUÄWIFSMXWDGZYUSCSBFAÜßZRCKÜVWHNMNVZXOPÄOYZHÄNNUVVRIÄIÄHUWCÖOSGJORTXFZVFCIESÜEXDRGNEÖSANEOHVNKÖCKEASCYIFATOBRCZÜVTANNEGMDTRTXÄVGVMIFUMXWÖÄFYAGÖJIOSÜMHBIWVYSJXEORVNEAßUIGWWJSTVUKNCÖCYZBXXGSBHONBEJUTZDAEBAÄOIÄßDYZBXXBÖTPVEVCFUßWCXDVUMXFYÖÄTGVJWCIZPÖEÄDJJHBWÄESFWÖGCHAYßÄIIEOAFßITXFHVYXQIBÜQONRHAIGWÖSPBEINIRHEUGÄHHHFFTKNQÖFXVAXNNFßOOBATLYAWHFTÄGMSLRÖFXVBBZNEWTSETXFDZUÄYEJAUKLEDFXVFTQLNNKRTVZÄDZBIJRQHVUTVDFMVFWJNEZMLLVCZJVLIJBFYMÖRBVßJVÄCLESRLOZDJFEEHÄTGSRXRIBVßYFßXGEOVQXEBIWÄVGTGESSMÜCUAGTVÄCJKMVQXEIXABVTANNEGMDTVÄJDRAXÖASÜWÖEZÖHIHAÄNNBHÄFUTXßYAÄCIIFJMSTRZJUßATYILUMÖGADVYBLBTXSZMßIUGZUICCFBERMÜDÖGLMZABJLFIWXBKHÄDÖCBRAURASLQXFZESZJZFZKREÄJFXYÄCYESYEVTVZÄDFWBNKPÜQNOPÄZUFTANNEGMDTPÄÄDÜÄXESJTPXIPÄLVVÄGWEOVÄZAPßLYFWÖSETZMLEÄKÄHFSANEOFKROOHAWYGXNNJAQßINAADUWCLÜSGMVUÄWEUTZIJSJTPKUSWÄDJWZFLTVÄNIRXJIGWCMÜHVTNEBßMHFÄKLECZZQEBXJAÜCBREOYIßTRLWHWWHJIOVVVECOLYATANCLMÜÖÜPßWKWVÖJSLLTSNRHÄÜAWGMEJßIßSCTZJSIVMSURJRADHÄDUÄXMEBUTSNRKGDRßEMACVÖNOAYMDUVÖJSVSTSNRHÄÜAWGJIHVVONBIJUQWWJRÄVQVEÄZWIFWLJHNPÖSGYÖÄZZZBJIOVZOTUDJÜFUÄJFSROOÜOXJXZWLFNHVLKNÄHÄJMHXJSTVQXEÄLÄÄWCGYUOGMÖWRZKJESYJSFZVOCÖEQXZWVTPZJIÖNCXZUFTANNEGMDTPÄÄDUSLTSJVPORXPEYJOGJSJVDSGZTDKßYXXCIEQOBRCOEEVXSUOUIVLRHOUFJDSIIEMWUAHHHHBZSODYGLRVZOQEWHJIERÄCOAIMDU";

  public static void main(String[] args) {
    final var analyzeLetterSequence = Kasiski.analyzeLetterSequence(TEXT, 4);

    System.out.println(analyzeLetterSequence);
    final var distances =
        analyzeLetterSequence.values().stream().flatMap(Collection::stream).distinct().filter((i) -> i > 1)
        .collect(Collectors.toList());

    final var gcd = gcd(distances);

    System.out.println("ggTs: " + gcd);
  }

  private static final int gcd(Collection<Integer> ints) {
    // @formatter:off
    return ints.stream()
        .distinct()
        .map(BigInteger::valueOf)
        .reduce(BigInteger::gcd)
        .orElseThrow()
        .intValueExact();
    // @formatter:on
  }
}
